<html lang="en">
<head>
    <title>three.js canvas - geometry - cube</title>
    <style type="text/css">
        /*CSS*/
        .sidenav { /*side bar settings*/
            height: 100%;
            width: 243px;
            position: fixed;
            /*z-index: 1;*/
            top: 0;
            right: 1px;
            text-align: left;
            overflow-x: scroll;
            overflow-y: scroll;
            background-color: gray;
            border: 1px solid black;
        }

    </style>

</head>

<body>
    <div class="sidenav">
        <button onclick="rotate()" type="button">Rotate</button>
    </div>
    <div class="main">
        <!-- include javascript files -->
        <script src="./ts/lib/three.js"></script>
        <script type="text/javascript">
            var width = window.innerWidth;
            var height = window.innerHeight;

            var renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(width, height);
            document.body.appendChild(renderer.domElement);

            var scene = new THREE.Scene();
            var WHITE = new THREE.Color();
            scene.background = WHITE;

            var cubeGeometry = new THREE.CubeGeometry(50, 50, 50);
            var cubeMaterial = new THREE.MeshLambertMaterial({ color: 0xffffff });
            var cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
            var cube1 = new THREE.Mesh(cubeGeometry, cubeMaterial);
            //cube.rotation.y = Math.PI * 45 / 180;
            cube.translateX(50);
            cube1.translateX(150);
            var group = new THREE.Group();
            group.add(cube);
            group.add(cube1);
            scene.add(group);

            var camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 10000);
            camera.position.y = 160;
            camera.position.z = 400;
            camera.lookAt(new THREE.Vector3());

            scene.add(camera);

            var skyboxGeometry = new THREE.CubeGeometry(10000, 10000, 10000);
            var skyboxMaterial = new THREE.MeshBasicMaterial({ color: 0x000000, side: THREE.BackSide });
            var skybox = new THREE.Mesh(skyboxGeometry, skyboxMaterial);

            //scene.add(skybox);

            var pointLight = new THREE.PointLight(0xffffff);
            pointLight.position.set(0, 300, 200);

            scene.add(pointLight);

            var clock = new THREE.Clock();

            //Add arrows to scene to add reference location for DNA/RNA in scene
            let dir = new THREE.Vector3(1, 0, 0); //direction for x-axis
            dir.normalize(); //normalize the direction vector (convert to vector of length 1) - although already length 1
            let Origin = new THREE.Vector3(0, 0, 0);
            var length = 200;
            let hex = 0x000080; //arrow colors
            let arrowHelper = new THREE.ArrowHelper(dir, Origin, length, hex); //create x-axis arrow
            arrowHelper.name = "x-axis";
            scene.add(arrowHelper); //add x-axis arrow to scene
            dir = new THREE.Vector3(0, 1, 0); //direction for y-axis
            dir.normalize(); //normalize the direction vector (convert to vector of length 1) - although already length 1
            arrowHelper = new THREE.ArrowHelper(dir, Origin, length, hex);
            arrowHelper.name = "y-axis";
            scene.add(arrowHelper); //add y-axis arrow to scene
            dir = new THREE.Vector3(0, 0, 1); //direction for z-axis
            dir.normalize(); //normalize the direction vector (convert to vector of length 1) - although already length 1
            arrowHelper = new THREE.ArrowHelper(dir, Origin, length, hex);
            arrowHelper.name = "z-axis";
            scene.add(arrowHelper); //add z-axis to scene

            function render() {
                requestAnimationFrame(render);

                //cube.rotation.y -= clock.getDelta();

                renderer.render(scene, camera);
            }

            function rotate() {
                let axisMode = "X";
                let angle = 30 * Math.PI / 180;
                let p = cube.position;
                let c = new THREE.Vector3(100,0,0);
                let d = p.sub(c);
                let matrix;
                matrix = new THREE.Matrix3();
                if (axisMode == "X") {
                    matrix.set(1, 0, 0, 0, Math.cos(angle), -Math.sin(angle), 0, Math.sin(angle), Math.cos(angle));
                    cube.rotateX(-1 * angle);
                }
                else if (axisMode == "Y") {
                    matrix.set(Math.cos(angle), 0, Math.sin(angle), 0, 1, 0, -Math.sin(angle), 0, Math.cos(angle));
                    cube.rotateY(-1 * angle);
                }
                else {
                    matrix.set(Math.cos(angle), -Math.sin(angle), 0, Math.sin(angle), Math.cos(angle), 0, 0, 0, 1);
                    cube.rotateZ(-1 * angle);
                }
                d.applyMatrix3(matrix);
                d.add(c);
                cube.position = d;
                render();
            }

            render();

        </script>
    </div>
</body>
</html>